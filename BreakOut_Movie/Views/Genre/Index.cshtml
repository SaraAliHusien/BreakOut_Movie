
@model IEnumerable<Genre>

@{
    ViewData["Title"] = "Genre Page";
}
<div class="container">
    <div class=" row  d-flex pt-5">
        <div class="col-6 headers">
            @if (Model.Any())
            {
                <h2>
                    All Genres

                </h2>
            }
        </div>

        <div class="col-6 d-flex justify-content-end align-items-end mb-2  ">

            <a asp-action="Create" asp-controller="Genre" class="add-btn">
                <i class="bi bi-patch-plus"></i> Add Genre
            </a>
        </div>

    </div>
    <div class=" container  col-12 ">
        @{
            if (Model.Any())
       
            {
                <div class="row  card-group">

                    @foreach (var genre in Model)
                    {

                        <div class="col-xl-2  col-md-4 col-sm-6 col-6 mt-4 border-radius-md grand-parent">

                            <div class="card card-profile mt-md-0 border-0 " style="background-color:inherit">

                                <div class=" pb-0 ">
                                    <img class="w-100 border-radius-md " height="280" src="data:image/*;base64 ,@(Convert.ToBase64String(genre.Image!))">
                                </div>

                                <div class="card-body  mt-0  border-radius-md p-1 pt-1">


                                    <div class="row d-flex justify-content-end align-items-end">
                                        <div class="col-8 pt-0 mt-0 genre-h">
                                            <h6 class="m-0 p-0">@genre.Name</h6>

                                        </div>
                                        <div class="col-4 pt-1 d-flex justify-content-end align-items-end genre-btn">
                                            <a asp-action="Edit" asp-route-id="@genre.Id">
                                                <i class="bi bi-pencil-square edit"></i>
                                            </a>
                                            <a href="javaScript:;" class="js-delete" data-id="@genre.Id">

                                                <i class="bi bi-trash3-fill delete"></i>
                                            </a>
                                        </div>


                                    </div>
                                </div>




                            </div>
                        </div>





                    }
                </div>
            }
            else
            {
                <div class="alert alert-warning alert-dismissible d-flex align-items-center fade show mt-5">
                    <i class="bi-exclamation-triangle-fill"></i>
                    <strong class="mx-2">Warning!</strong> No Genre found ....

                </div>
            }
        }


    </div>
</div>

 @section Scripts{
      <script>

        $(document).ready(function () {

            $('.js-delete').on('click', function () {
                var btn = $(this);
                Swal.fire({
                    title: "Are you sure you want to delete this Genre? ",
                    icon: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#f9b17a",
                    cancelButtonColor: "gray",
                    confirmButtonText: " Delete",
                    color: "#f78316",
                    background: "#1b3c59 ",
                }).then((result) => {
                    if (result.isConfirmed) {

                        $.ajax({
                            url: '/Genre/Delete/' + btn.data('id'),
                            success: function () {
                                Swal.fire({
                                    title: "Deleted!",
                                    text: "The Genre has been deleted.",
                                    icon: "success",
                                    confirmButtonColor: "#f9b17a",
                                    color: "#f78316",
                                    background: "#1b3c59 ",
                                });
                                btn.parents('.grand-parent').addClass('animate__bounceOut');

                                setTimeout(function () {
                                    btn.parents('.grand-parent').remove();
                                }, 500);
                               

                            },

                            error: function () {
                                Swal.fire({

                                    title: "Ooooops!",
                                    text: "Can not delete this genre. There are some movies with it.",
                                    icon: "error",
                                    confirmButtonColor: "#c62d2d",
                                    color: "#c62d2d",
                                    background: "#1b3c59 ",
                                });


                            }
                        });

                    }
                });

            });
        });
  </script>
   }